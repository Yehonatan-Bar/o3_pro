# pip install --upgrade openai
# export OPENAI_API_KEY=sk-...   # or set in your OS key store

from openai import OpenAI
import os
import sys

# --- hard-coded local path to the file you want analyzed ---
FILE_PATH = r"C:\Users\yourname\Downloads\attachment.pdf"   # <-- change this

def main():
    if not os.path.exists(FILE_PATH):
        print(f"File not found: {FILE_PATH}", file=sys.stderr)
        sys.exit(1)

    client = OpenAI()  # reads OPENAI_API_KEY from env

    # 1) Upload the file so the model can reference it
    uploaded = client.files.create(
        file=open(FILE_PATH, "rb"),
        purpose="user_data"  # general-purpose file inputs for Responses API
    )

    # 2) Call o3-pro and include the uploaded file as an input part
    resp = client.responses.create(
        model="o3-pro",
        reasoning={"effort": "high"},  # let o3-pro think a bit; adjust to "high" for tougher tasks
        input=[
            {
                "role": "user",
                "content": [
                    {"type": "input_file", "file_id": uploaded.id},
                    {"type": "input_text",
                     "text": "Read the attached file and give me a concise summary with three key takeaways."}
                ]
            }
        ]
    )

    # 3) Print model text output
    out_text = []
    for item in resp.output:
        if getattr(item, "content", None):
            for c in item.content:
                if getattr(c, "text", None):
                    out_text.append(c.text)
    print("".join(out_text))

if __name__ == "__main__":
    main()
